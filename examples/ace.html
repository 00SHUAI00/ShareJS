<html>
	<head>
		<style type="text/css" media="screen">
			body {
				overflow: hidden;
			}
			
			#editor { 
				margin: 0;
				position: absolute;
				top: 0;
				bottom: 0;
				left: 0;
				right: 0;
			}
		</style>
	</head>

	<body>
		<div id="editor">Loading...</div>
		<script src="ace/ace.js" type="text/javascript" charset="utf-8"></script>
		<script src="ace/mode-coffee.js" type="text/javascript" charset="utf-8"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script src="share.js"></script>
		<script src="ace.js"></script>
		<script>

    window.onload = function() {
        var editor = ace.edit("editor");
//		var editorDoc = editor.getSession().getDocument();
//		editorDoc.setNewLineMode('unix');
//		window.doc = editorDoc;
//		var convert = aceDeltaToSharejsOp(editorDoc);
		
		var connection = new whatnot.Connection('sephsmac.local', 8000);
		connection.getOrCreate('acetest2', function(doc, error) {
			if (error) {
				console.error(error);
				return;
			}
			doc.attach_ace(editor);
			console.log('attached');
		});

		var CoffeeScriptMode = require("ace/mode/coffee").Mode;
		editor.getSession().setMode(new CoffeeScriptMode());
    };
		</script>
	</body>
</html>	

